coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
install.packages("reshape")
install.packages("hrbrthemes")
install.packages("gridExtra")
install.packages("gridExtra")
install.packages("gridExtra")
install.packages("gridExtra")
install.packages("gridExtra")
library(gridExtra)
library(hrbrthemes)
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
#add here the genome size in bp
genomes_size=903581644
kd_melt = melt(KimuraDistance,id="Div")
library(reshape)
kd_melt = melt(KimuraDistance,id="Div")
kd_melt$norm = kd_melt$value/genomes_size * 100
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
library(ggplot2)
library(tidyverse)
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
library(viridis)
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
#coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
#coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55))
View(KimuraDistance)
View(kd_melt)
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
setwd("/workdir/azwad/shad-genome")
knitr::root.dir("/workdir/azwad/shad-genome")
root.dir("/workdir/azwad/shad-genome")
library(knitr)
root.dir("/workdir/azwad/shad-genome")
setwd
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
setwd("/workdir/azwad/shad-genome")
setwd("/workdir/azwad/shad-genome")
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("chrom", "start", "length")) %>%
select(c(chrom, length)) %>%
filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom))))
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
setwd("/workdir/azwad/shad-genome")
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("chrom", "start", "length")) %>%
select(c(chrom, length)) %>%
filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom))))
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
setwd("/workdir/azwad/shad-genome")
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("chrom", "start", "length")) %>%
select(c(chrom, length)) %>%
filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom))))
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
setwd("/workdir/azwad/shad-genome")
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("chrom", "start", "length")) %>%
select(c(chrom, length)) %>%
filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom))))
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type), type = ifelse(type == "SINE?", "SINE", type))
setwd("/workdir/azwad/shad-genome")
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type), type = ifelse(type == "SINE?", "SINE", type))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("chrom", "start", "length")) %>%
select(c(chrom, length)) %>%
filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom))))
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
## Code from Kristina Galagova; See: https://github.com/oushujun/EDTA/issues/92
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
## Code from Kristina Galagova; See: https://github.com/oushujun/EDTA/issues/92
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
## Code from Kristina Galagova; See: https://github.com/oushujun/EDTA/issues/92
setwd("/workdir/azwad/shad-genome")
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
#add here the genome size in bp
genomes_size=903581644
kd_melt = melt(KimuraDistance,id="Div")
kd_melt$norm = kd_melt$value/genomes_size * 100
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
## Code from Kristina Galagova; See: https://github.com/oushujun/EDTA/issues/92
setwd("/workdir/azwad/shad-genome")
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
#add here the genome size in bp
genomes_size=903581644
kd_melt = melt(KimuraDistance,id="Div")
kd_melt$norm = kd_melt$value/genomes_size * 100
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
setwd("/workdir/azwad/shad-genome")
shad_repeats <-
read_tsv(
"repeats/genome_mask/fAloSap1_repeats.out",
col_names = c("chrom", "start", "end", "type")
) %>% mutate(type = gsub("\\/.*","", type), type = ifelse(type == "SINE?", "SINE", type))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("chrom", "start", "length")) %>%
select(c(chrom, length)) %>%
filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom))))
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
## Code from Kristina Galagova; See: https://github.com/oushujun/EDTA/issues/92
setwd("/workdir/azwad/shad-genome")
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
#add here the genome size in bp
genomes_size=903581644
kd_melt = melt(KimuraDistance,id="Div")
kd_melt$norm = kd_melt$value/genomes_size * 100
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
## Code from Kristina Galagova; See: https://github.com/oushujun/EDTA/issues/92
setwd("/workdir/azwad/shad-genome")
KimuraDistance <- read.csv("repeats/genome_mask_2/GCF_018492685.fa.distance", sep=" ")
#add here the genome size in bp
genomes_size=903581644
kd_melt = melt(KimuraDistance,id="Div")
kd_melt$norm = kd_melt$value/genomes_size * 100
ggplot(kd_melt, aes(fill=variable, y=norm, x=Div)) +
geom_bar(position="stack", stat="identity",color="black") +
scale_fill_viridis(discrete = T) +
theme_classic() +
xlab("Kimura substitution level") +
ylab("Percent of the genome") +
labs(fill = "") +
coord_cartesian(xlim = c(0, 55)) +
theme(axis.text=element_text(size=11),axis.title =element_text(size=12))
fAloSap1_psmc <- readRDS("psmc/output_run_psmc.rds")
plot(
fAloSap1_psmc,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 4.5,
bin.size = 100,
xlim = c(10000,500000)
)
library(psmcr)
library(pegas)
library(tidyverse)
fAloSap1_psmc <- readRDS("psmc/output_run_psmc.rds")
plot(
fAloSap1_psmc,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 4.5,
bin.size = 100,
xlim = c(10000,500000)
)
plot(
fAloSap1_psmc,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 4.5,
bin.size = 100
)
plot(
fAloSap1_psmc,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 4.5,
bin.size = 100,
xlim = c(10000,300000)
)
plot(
fAloSap1_psmc,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 4.5,
bin.size = 100,
xlim = c(10000,200000)
)
install.packages("kableExtra")
install.packages("kableExtra")
