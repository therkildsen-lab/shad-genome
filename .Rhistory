coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
?scale_fill_viridis_b
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis_b(direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0)) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0)) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme(
strip.text.y.left = element_text(angle = 0)) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
theme_minimal() +
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0)) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "gray")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "white"
)
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "white"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "gray")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "white"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "gray90")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "white"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "gray80")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "white"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "gray85")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "white"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "gray88")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
repeat_plot <- shad_repeats %>% filter(chrom %in% chroms) %>%
mutate(chrom = as.integer(str_sub(chrom, 4, str_length(chrom)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = start, ymax = end, fill = type),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
#scale_fill_viridis(discrete = TRUE, direction = -1) +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap( ~ `chrom`, nrow = length(chroms), strip.position = "left")
repeat_plot
View(shad_repeats)
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(cowplot)
library(knitr)
# Load in all the data
# Load in list of SNPs with depth
snps <-
read_tsv("../reads/fAloSap1_snps.bed",
col_names = c("Chromosome", "Position0", "End", "Depth"))
# Raw per-site read depth
cov_nogaps <- read_tsv(
"../reads/fAloSap1_pacbio_dedup_ucsc.coverage",
col_names = c("Chromosome", "Position", "Depth")
) %>%
filter(Chromosome %in% paste0("chr", c(1:24))) %>%
mutate(Chromosome = as.integer(str_sub(Chromosome, 4, str_length(Chromosome))))
# Calculate mean coverage
mean_cov  <- cov_nogaps %>%
pull(Depth) %>% mean()
chroms <- paste0("chr", c(1:24))
# Coverage in BedGraph format (Region intervals of uniform coverage)
cov <-
read_tsv(
"../reads/fAloSap1_pacbio_coverage.ucsc.bedGraph",
col_names = c("Chromosome", "Start", "End", "Depth")
) %>%
filter(Chromosome %in% paste0("chr", c(1:24))) %>%
mutate(Chromosome = as.integer(str_sub(Chromosome, 4, str_length(Chromosome))))
# Filter SNPs to keep only SNPs without excess or low coverage (2x mean coverage, 1/3x coverage)
snps_filtered <- snps %>%
filter(Chromosome %in% paste0("chr", c(1:24)),
Depth > mean_cov / 3,
Depth < mean_cov * 2) %>%
mutate(Chromosome = as.integer(str_sub(Chromosome, 4, str_length(Chromosome))))
# Break SNPs into 1mb windows
snp_1mb_window <- snps_filtered %>%
mutate(ints = cut_width(End, width = 1e6, boundary = 0)) %>%
group_by(Chromosome, ints) %>%
summarize(snp_per_kb = n() / (1e6 / 1e3),
int_start = min(End)) %>%
mutate(chrom_odd = ifelse(Chromosome %% 2 == 1, "odd", "even"))
## Snps per kb, 1mb windows
snp_window_plot <- snp_1mb_window %>%
ggplot() +
geom_col(
aes(x = int_start, y = snp_per_kb, fill = chrom_odd),
position = "jitter",
width = 1000000
) +
facet_wrap(
~ `Chromosome`,
ncol = 24,
strip.position = "top",
scales = "free_x"
) +
ggtitle("Heterozygosity by Chromosome (1mb windows) \n fAloSap1.pri") +
xlab("Position") +
ylab("Heterozygosity per kb") +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines")
) +
scale_fill_manual(values = c("dodgerblue4", "cornflowerblue"))
snp_window_plot
snp_hist_1mb <- snp_1mb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb))
snp_hist_1mb
snp_hist_1mb <- snp_1mb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1)
snp_hist_1mb
snp_hist_1mb <- snp_1mb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.01)
snp_hist_1mb
snp_hist_1mb <- snp_1mb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.05)
snp_hist_1mb
snp_50kb_window <- snps_filtered %>%
mutate(ints = cut_width(End, width = 5e4, boundary = 0)) %>%
group_by(Chromosome, ints) %>%
summarize(snp_per_kb = n() / (5e4 / 1e3),
int_start = min(End)) %>%
mutate(chrom_odd = ifelse(Chromosome %% 2 == 1, "odd", "even"))
# Dashed line is mean genome-wide heterozygosity per kb
snp_window_plot_50kb <- snp_50kb_window %>%
ggplot() +
geom_point(aes(x = int_start, y = snp_per_kb, color = chrom_odd),
size = 0.5) +
geom_hline(aes(yintercept = nrow(snps_filtered) / ((nrow(cov_nogaps) - sum(no_cov$End - no_cov$Start)) / 1000)),
linetype = "dashed",
color = "red",
size = 1) +
facet_wrap(
~ `Chromosome`,
ncol = 24,
strip.position = "top",
scales = "free_x"
) +
ggtitle("Heterozygosity by Chromosome (50kb windows) \n fAloSap1.pri") +
xlab("") +
ylab("Heterozygosity per kb") +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines")
) +
scale_color_manual(values = c("dodgerblue4", "cornflowerblue"))
het_cov_plot_50kb <- plot_grid(snp_window_plot_50kb,
genome_cov_plot,
ncol = 1,
align = "v")
snp_window_plot_50kb
no_cov <- cov %>% filter(Depth == 0)
snp_window_plot_50kb
snp_hist_50kb
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.05)
snp_hist_50kb
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1)
snp_hist_50kb
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1) + xlab("Heterozygosity") + ylab("# of Bins")
snp_hist_50kb
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1) + xlab("Heterozygosity") + ylab("# of Windows") + title("")
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1) + xlab("Heterozygosity") + ylab("# of Windows") + title("")
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1, color = "black", fill = "dodgerblue4") + xlab("Heterozygosity") + ylab("# of Windows")
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1, color = "black", fill = "dodgerblue4") + xlab("Heterozygosity") + ylab("# of Windows")
snp_hist_50kb
repeat_plot
library(readr)
bcftools_roh_042123 <- read_delim("reads/bcftools_roh_042123.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE, skip = 4)
View(bcftools_roh_042123)
unique(bcftools_roh_042123$`# ST`)
bcftools_roh_042123 %>% filter(`# ST` == "RG")
bcftools_roh_042123 %>% filter(`# ST` == "RG")
bcftools_roh_042123 %>% filter(`# ST` == "RG") %>% kable()
bcftools_roh_042123 %>% filter(`# ST` == "RG") %>% mutate(length = `[4]Position` - `[5]State (0:HW, 1:AZ)`)
