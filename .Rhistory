ggplot() +
geom_point(aes(x = int_start, y = snp_kb, color = chrom_odd),
size = 0.5) +
geom_hline(aes(yintercept = snp_kb / nrow(snp_gt_50kb_window_filtered)),
linetype = "dashed",
color = "red",
size = 1) +
facet_wrap(
~ `Chromosome`,
ncol = 24,
strip.position = "top",
scales = "free_x"
) +
ggtitle("Heterozygosity by Chromosome (50kb windows) \n fAloSap1.pri") +
xlab("") +
ylab("Heterozygosity per kb") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines")
) +
scale_color_manual(values = c("dodgerblue4", "cornflowerblue"))
het_cov_plot_50kb <- plot_grid(snp_window_plot_50kb,
genome_cov_plot,
ncol = 1,
align = "v")
snp_window_plot_50kb
# Dashed line is mean genome-wide heterozygosity per kb
snp_window_plot_50kb <- snp_gt_50kb_window_filtered %>%
ggplot() +
geom_point(aes(x = int_start, y = snp_kb, color = chrom_odd),
size = 0.5) +
geom_hline(aes(yintercept = mean(snp_kb)),
linetype = "dashed",
color = "red",
size = 1) +
facet_wrap(
~ `Chromosome`,
ncol = 24,
strip.position = "top",
scales = "free_x"
) +
ggtitle("Heterozygosity by Chromosome (50kb windows) \n fAloSap1.pri") +
xlab("") +
ylab("Heterozygosity per kb") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines")
) +
scale_color_manual(values = c("dodgerblue4", "cornflowerblue"))
snp_window_plot_50kb
snp_gt_50kb_window_filtered %>% pull(snp_kb) %>% mean()
snp_gt_50kb_window_filtered %>% pull(snp_kb) %>% max()
View(snp_gt_50kb_window_filtered)
snp_gt_50kb_window_filtered %>% pull(snp_kb)
mean(snp_gt_50kb_window_filtered$snp_kb)
head(snp_gt_50kb_window_filtered
head(snp_gt_50kb_window_filtered)
head(snp_gt_50kb_window_filtered)
snp_kb_50kb <- snp_gt_50kb_window_filtered %>% pull(snp_kb)
mean(snp_kb_50kb)
head(snp_kb_50kb)
is.na(snp_kb_50kb)
View(snp_gt_50kb_window_filtered)
View(snp_50kb_window)
snp_50kb_window <- snps_filtered %>%
mutate(ints = cut_width(End, width = 5e4, boundary = 0)) %>%
group_by(Chromosome, ints, type) %>%
count() %>% pivot_wider(values_from = n, names_from = type) %>%
mutate(snp = ifelse(is.na(snp) == T, 0, snp))
min(snp_50kb_window$snp)
unique(is.na(snp_50kb_window$snp))
table(is.na(snp_50kb_window$snp))
snp_gt_50kb_window <- left_join(gt_50kb_window, snp_50kb_window) %>%
mutate(snp_kb = snp / (5e4/1e3))
snp_1mb_window <- snps_filtered %>%
mutate(ints = cut_width(End, width = 1e6, boundary = 0)) %>%
group_by(Chromosome, ints, type) %>%
count() %>% pivot_wider(values_from = n, names_from = type)  %>%
mutate(snp = ifelse(is.na(snp) == T, 0, snp))
snp_gt_1mb_window <- left_join(gt_1mb_window, snp_1mb_window) %>%
mutate(snp_kb = snp / (1e6/1e3))
unique(is.na(snp_gt_1mb_window$snp))
saveRDS(snp_gt_1mb_window, file = "../reads/snp_gt_1mb_window.rds")
snp_gt_50kb_window <- left_join(gt_50kb_window, snp_50kb_window) %>%
mutate(snp_kb = snp / (5e4/1e3))
saveRDS(snp_gt_50kb_window, file = "../reads/snp_gt_50kb_window.rds")
snp_gt_50kb_window <- readRDS("../reads/snp_gt_50kb_window.rds")
snp_gt_50kb_window_filtered <- snp_gt_50kb_window %>% filter(genotype_rate >= 0.5)
snp_kb_50kb <- snp_gt_50kb_window_filtered %>% pull(snp_kb)
# Dashed line is mean genome-wide heterozygosity per kb
snp_window_plot_50kb <- snp_gt_50kb_window_filtered %>%
ggplot() +
geom_point(aes(x = int_start, y = snp_kb, color = chrom_odd),
size = 0.5) +
geom_hline(aes(yintercept = mean(snp_kb)),
linetype = "dashed",
color = "red",
size = 1) +
facet_wrap(
~ `Chromosome`,
ncol = 24,
strip.position = "top",
scales = "free_x"
) +
ggtitle("Heterozygosity by Chromosome (50kb windows) \n fAloSap1.pri") +
xlab("") +
ylab("Heterozygosity per kb") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines")
) +
scale_color_manual(values = c("dodgerblue4", "cornflowerblue"))
het_cov_plot_50kb <- plot_grid(snp_window_plot_50kb,
genome_cov_plot,
ncol = 1,
align = "v")
snp_window_plot_50kb
snp_hist_50kb <- snp_50kb_window %>% ggplot() + geom_histogram(aes(x = snp_per_kb), binwidth = 0.1, color = "black", fill = "dodgerblue4") + xlab("Heterozygosity") + ylab("# of Windows") + theme_classic()
snp_hist_50kb
snp_gt_50kb_window_filtered <- snp_gt_50kb_window %>% filter(genotype_rate >= 0.5)
snp_kb_50kb <- snp_gt_50kb_window_filtered %>% pull(snp_kb)
# Dashed line is mean genome-wide heterozygosity per kb
snp_window_plot_50kb <- snp_gt_50kb_window_filtered %>%
ggplot() +
geom_point(aes(x = int_start, y = snp_kb, color = chrom_odd),
size = 0.5) +
geom_hline(aes(yintercept = mean(snp_kb)),
linetype = "dashed",
color = "red",
size = 1) +
facet_wrap(
~ `Chromosome`,
ncol = 24,
strip.position = "top",
scales = "free_x"
) +
ggtitle("Heterozygosity by Chromosome (50kb windows) \n fAloSap1.pri") +
xlab("") +
ylab("Heterozygosity per kb") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines")
) +
scale_color_manual(values = c("dodgerblue4", "cornflowerblue"))
het_cov_plot_50kb <- plot_grid(snp_window_plot_50kb,
genome_cov_plot,
ncol = 1,
align = "v")
snp_window_plot_50kb
snp_hist_50kb <- snp_gt_50kb_window_filtered %>% ggplot() + geom_histogram(aes(x = snp_kb), binwidth = 0.1, color = "black", fill = "dodgerblue4") + xlab("Heterozygosity") + ylab("# of Windows") + theme_classic()
snp_hist_50kb
het_cov_plot_50kb
genome_cov_plot <- cov_50kb %>%
ggplot() +
geom_point(aes(x = Start, y = mean_depth),
size = 0.5) +
geom_hline(aes(yintercept = mean_cov),
linetype = "dashed",
color = "red",
size = 1) +
xlab("Position") +
ylab("Mean Coverage per 50 kb") +
facet_wrap(~ `Chromosome`,
ncol = length(chroms),
scales = "free_x") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines"),
strip.background = element_blank(),
strip.text.x = element_blank()
)
genome_cov_plot
chrom_size <- read_tsv("../assembly/sizes.genome.ucsc", col_names = c("Chromosome", "Start", "End"))
no_cov <- cov_50kb %>% filter(mean_depth < 5)
genome_cov_plot <- cov_50kb %>%
ggplot() +
geom_point(aes(x = Start, y = mean_depth),
size = 0.5) +
geom_hline(aes(yintercept = mean_cov),
linetype = "dashed",
color = "red",
size = 1) +
xlab("Position") +
ylab("Mean Coverage per 50 kb") +
ylim(c(0, 200)) +
facet_wrap(~ `Chromosome`,
ncol = length(chroms),
scales = "free_x") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines"),
strip.background = element_blank(),
strip.text.x = element_blank()
)
genome_cov_plot
chrom_size <- read_tsv("../assembly/sizes.genome.ucsc", col_names = c("Chromosome", "Start", "End"))
no_cov <- cov_50kb %>% filter(mean_depth < 5)
genome_cov_plot <- cov_50kb %>%
ggplot() +
geom_point(aes(x = Start, y = mean_depth),
size = 0.5) +
geom_hline(aes(yintercept = mean_cov),
linetype = "dashed",
color = "red",
size = 1) +
xlab("Position") +
ylab("Mean Coverage per 50 kb") +
ylim(c(0, 500)) +
facet_wrap(~ `Chromosome`,
ncol = length(chroms),
scales = "free_x") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines"),
strip.background = element_blank(),
strip.text.x = element_blank()
)
genome_cov_plot
genome_cov_plot <- cov_50kb %>%
ggplot() +
geom_point(aes(x = Start, y = mean_depth),
size = 0.5) +
geom_hline(aes(yintercept = mean_cov),
linetype = "dashed",
color = "red",
size = 1) +
xlab("Position") +
ylab("Mean Coverage per 50 kb") +
ylim(c(0, 400)) +
facet_wrap(~ `Chromosome`,
ncol = length(chroms),
scales = "free_x") +
theme_classic() +
theme(
legend.position = "none",
axis.text.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.ticks.x = element_blank(),
plot.background = element_rect(fill = "white"),
panel.spacing.x = unit(0, "lines"),
strip.background = element_blank(),
strip.text.x = element_blank()
)
genome_cov_plot
setwd("/workdir/azwad/shad-genome")
library(viridis)
shad_roh <-
read_table(
"reads/plink.hom"
) %>% mutate(CHR = paste0("chr",CHR))
chroms <- paste0("chr", c(1:24))
chrom_sizes <-
read_tsv("assembly/sizes.genome.ucsc",
col_names = c("CHR", "start", "length")) %>%
select(c(CHR, length)) %>%
filter(CHR %in% chroms) %>%
mutate(CHR = as.integer(str_sub(CHR, 4, str_length(CHR))))
roh_plot <- shad_roh %>% filter(CHR %in% chroms) %>%
mutate(CHR = as.integer(str_sub(CHR, 4, str_length(CHR)))) %>%
ggplot()  +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = NA,
fill = "gray90"
) +
geom_rect(
aes(ymin = POS1, ymax = POS2, fill = KB),
xmin = 0,
xmax = 1,
alpha = 1
) +
geom_rect(
data = chrom_sizes,
aes(ymin = 0, ymax = length),
xmin = 0,
xmax = 1,
col = "black" ,
fill = NA
) +
ylab("Position") +
scale_fill_viridis() +
theme_minimal() +
theme(
strip.text.y.left = element_text(angle = 0),
plot.background = element_rect(fill = "white")) +
coord_flip() +
facet_wrap(~CHR, nrow = length(chrom_sizes$CHR), strip.position = "left") + ggtitle("Runs of Homozygosity (ROH)")
roh_plot
getwd()
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
#read in tab and convert to ucsc naming
getwd()
#read in tab and convert to ucsc naming
getwd()
#read in tab and convert to ucsc naming
setwd("/workdir/azwad/shad-genome/")
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
root.dir("/workdir/azwad/shad-genome/"))
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
root.dir("/workdir/azwad/shad-genome/")
root.dir
library(knitr)
root.dir
root.dir()
knitr::opts_knit$set(root.dir = '/workdir/azwad/shad-genome/')
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
knitr::opts_knit$set(root.dir = '/workdir/azwad/shad-genome/')
#read in tab and convert to ucsc naming
getwd()
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
knitr::opts_knit$set(root.dir = '/workdir/azwad/shad-genome/')
#read in tab and convert to ucsc naming
getwd()
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE, root.dir = '/workdir/azwad/shad-genome/')
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
#read in tab and convert to ucsc naming
getwd()
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE, root.dir = '/workdir/azwad/shad-genome')
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
#read in tab and convert to ucsc naming
getwd()
#read in tab and convert to ucsc naming
getwd()
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE, root.dir = '/workdir/azwad/shad-genome')
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
#read in tab and convert to ucsc naming
read_table("last/last_fAloSap1-medaka.tab")
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = '/workdir/azwad/shad-genome')
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
#read in tab and convert to ucsc naming
read_table("last/last_fAloSap1-medaka.tab")
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = '/workdir/azwad/shad-genome')
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = '/workdir/azwad/shad-genome')
#read in tab and convert to ucsc naming
read_table("last/last_fAloSap1-medaka.tab")
knitr::opts_knit$set(
root.dir = rprojroot::find_rstudio_root_file()
)
knitr::opts_chunk$set(echo = TRUE, fig.width = 15, warning = FALSE, message = FALSE)
library(tidyverse)
library(viridis)
library(reshape)
library(hrbrthemes)
library(gridExtra)
library(ggplot2)
#read in tab and convert to ucsc naming
read_table("last/last_fAloSap1-medaka.tab")
#read in tab and convert to ucsc naming
read_table("last/last_fAloSap1-medaka.tab")
#read in tab and convert to ucsc naming
getwd()
#read in tab and convert to ucsc naming
getwd()
read_table("last/last_fAloSap1-medaka.tab")
read_table("/last/last_fAloSap1-medaka.tab")
read_table("./last/last_fAloSap1-medaka.tab")
read_table("last/last_fAloSap1-medaka.tab")
read_table("last/last_fAloSap1_medaka.tab")
read_table("last/last_fAloSap1_medaka.tab", skip = 30)
#read in tab and convert to ucsc naming
getwd()
synteny_tab <- read_delim("last/last_fAloSap1_medaka.tab",
delim = "\t", escape_double = FALSE,
col_names = FALSE, trim_ws = TRUE, skip = 31)read_table("last/last_fAloSap1_medaka.tab", skip = 30)
#read in tab and convert to ucsc naming
getwd()
synteny_tab <- read_delim("last/last_fAloSap1_medaka.tab",
delim = "\t", escape_double = FALSE,
col_names = FALSE, trim_ws = TRUE, skip = 31)read_table("last/last_fAloSap1_medaka.tab", skip = 30)
#read in tab and convert to ucsc naming
getwd()
synteny_tab <- read_delim("last/last_fAloSap1_medaka.tab",
delim = "\t", escape_double = FALSE,
col_names = FALSE, trim_ws = TRUE, skip = 31)
View(synteny_tab)
#read in tab and convert to ucsc naming
synteny_tab <- read_delim("last/last_fAloSap1_medaka.tab",
delim = "\t", escape_double = FALSE,
col_names = FALSE, trim_ws = TRUE, skip = 31) %>% relocate(X7)
write_tsv(syneny_tab, "last/synteny_tab_mod.tab")
write_tsv(synteny_tab, "last/synteny_tab_mod.tab")
?write_tsv
#read in tab and convert to ucsc naming
synteny_tab <- read_delim("last/last_fAloSap1_medaka.tab",
delim = "\t", escape_double = FALSE,
col_names = FALSE, trim_ws = TRUE, skip = 31) %>% relocate(X7)
write_tsv(synteny_tab, "last/synteny_tab_mod.tab", col_names = F)
read_tsv()
?read_tsv()
read_tsv("last/last/synteny_tab_mod.ucsc.tab", col_names = F )
read_tsv("last/synteny_tab_mod.ucsc.tab", col_names = F )
