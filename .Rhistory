#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= medaka$col, alpha = 0.02)
medaka$col
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= turbo(n = nrow(medaka), alpha = 0.02))
turbo(n = 2)
medaka$col %>% head()
?circos.genomicLink
circos.genomicLink(medaka,shad, col= medaka$col, alpha = 0.02))
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= medaka$col, alpha = 0.02)
medaka_col$col <- turbo(n=24. , alpha = 0.02)
medaka <- left_join(medaka, medaka_col)
circos.genomicLink(medaka,shad, col= medaka$col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= medaka$col)
## break into two segments
# shad <- synteny_tab_corrected_filtered %>% select(shad_chr, shad_start, shad_end)
# medaka <- synteny_tab_corrected_filtered %>% select(medaka_chr, medaka_start, medaka_end)
shad <- synteny_tab_filtered %>% filter(length > 200) %>%  select(shad_chr, shad_start, shad_end)
medaka <- synteny_tab_filtered %>% filter(length > 200) %>% select(medaka_chr, medaka_start, medaka_end)
shad_col <-  shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,4,6)))
shad_col$col <- turbo(n=24 , alpha = 0.02)
shad <- left_join(shad, shad_col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= shad$col)
View(shad)
shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,4,6)))
shad %>% select(shad_chr) %>% unique() %>% as.integer(substr(shad_chr,4,6))
shad <- synteny_tab_filtered %>% filter(length > 200) %>%  select(shad_chr, shad_start, shad_end)
shad %>% select(shad_chr) %>% unique() %>% as.integer(substr(shad_chr,4,6))
shad %>% select(shad_chr) %>% unique()
shad %>% select(shad_chr) %>% unique() %>% substr(shad_chr,4,6)
shad %>% select(shad_chr) %>% unique() %>% substr(4,6)
View(medaka)
shad %>% select(shad_chr) %>% unique() %>% substr(8,10)
shad %>% select(shad_chr) %>% unique() %>% substr(11,12)
shad %>% select(shad_chr) %>% unique() %>% substr(12,14)
shad_col <-  shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,12,14)))
shad_col$col <- turbo(n=24 , alpha = 0.02)
View(shad_col)
shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,12,14)))
as.integer(substr(shad_col$shad_chr,12,14)))
as.integer(substr(shad_col$shad_chr,12,14))
substr(shad_col$shad_chr,12,14)
substr(shad_col$shad_chr,10,14)
substr(shad_col$shad_chr,9,14)
shad_col <-  shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,9,14)))
shad_col$col <- turbo(n=24 , alpha = 0.02)
shad <- left_join(shad, shad_col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= shad$col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= shad$col)
shad <- left_join(shad, shad_col)
View(shad)
shad_col$col <- turbo(n=24 , alpha = 0.02) %>% rev()
shad <- left_join(shad, shad_col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(medaka,shad, col= shad$col)
circos.genomicLink(shad,medaka, col= shad$col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= shad$col)
## break into two segments
# shad <- synteny_tab_corrected_filtered %>% select(shad_chr, shad_start, shad_end)
# medaka <- synteny_tab_corrected_filtered %>% select(medaka_chr, medaka_start, medaka_end)
shad <- synteny_tab_filtered %>% filter(length > 200) %>%  select(shad_chr, shad_start, shad_end)
medaka <- synteny_tab_filtered %>% filter(length > 200) %>% select(medaka_chr, medaka_start, medaka_end)
shad_col <-  shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,9,14)))
shad_col$col <- turbo(n=24 , alpha = 0.02)
shad <- left_join(shad, shad_col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= shad$col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= -shad$col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= rev(shad$col))
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= rev(shad$col))
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= medaka$col)
## break into two segments
# shad <- synteny_tab_corrected_filtered %>% select(shad_chr, shad_start, shad_end)
# medaka <- synteny_tab_corrected_filtered %>% select(medaka_chr, medaka_start, medaka_end)
shad <- synteny_tab_filtered %>% filter(length > 200) %>%  select(shad_chr, shad_start, shad_end)
medaka <- synteny_tab_filtered %>% filter(length > 200) %>% select(medaka_chr, medaka_start, medaka_end)
medaka_col <-  medaka %>% select(medaka_chr) %>% unique() %>% arrange(as.integer(substr(medaka_chr,4,6)))
medaka_col$col <- turbo(n=24. , alpha = 0.02)
medaka <- left_join(medaka, medaka_col)
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= medaka$col)
## break into two segments
# shad <- synteny_tab_corrected_filtered %>% select(shad_chr, shad_start, shad_end)
# medaka <- synteny_tab_corrected_filtered %>% select(medaka_chr, medaka_start, medaka_end)
shad <- synteny_tab_filtered %>% filter(length > 200) %>%  select(shad_chr, shad_start, shad_end)
medaka <- synteny_tab_filtered %>% filter(length > 200) %>% select(medaka_chr, medaka_start, medaka_end)
shad_col <-  shad %>% select(shad_chr) %>% unique() %>% arrange(as.integer(substr(shad_chr,4,6)))
shad_col$col <- turbo(n=24. , alpha = 0.02)
shad <- left_join(shad, shad_col)
circos.genomicLink(shad,medaka, col= rev(shad$col))
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= rev(shad$col))
circos.clear()
col_text <- "white"
circos.par("track.height"=0.8, gap.degree=0.5, cell.padding=c(0, 0, 0, 0))
circos.initialize(factors=combined_ref$X1, xlim=matrix(c(rep(0, 48), combined_ref$X3), ncol=2))
# genomes
circos.track(ylim=c(0, 1), panel.fun=function(x, y) {
chr=CELL_META$sector.index
xlim=CELL_META$xlim
ylim=CELL_META$ylim
circos.text(mean(xlim), mean(ylim), gsub(".*chr", "",chr), cex=1, col=col_text,
facing="bending.inside", niceFacing=TRUE)
}, bg.col=c(rep("gray70", 24), rep("cornflowerblue", 24)), bg.border=F, track.height=0.12)
brk <- c(0, 10, 20, 30, 40, 50, 60)*10^6
circos.track(track.index = get.current.track.index(), panel.fun=function(x, y) {
circos.axis(h="top", major.at=brk, labels=round(brk/10^7, 1), labels.cex=0.5,
col="grey30", labels.col="grey30", lwd=1, labels.facing="clockwise")
}, bg.border=F)
# circos.track(
#     ylim = c(0,10),
#     cell.padding = c(0, 0, 0, 0),
#     track.height = mm_h(1),
#     bg.lwd= 30,
#     bg.col = c(rep("gray80", 24), rep("cornflowerblue", 24)),
#     bg.border = F
# )
circos.genomicLink(shad,medaka, col= rev(shad$col))
fAloSap1_psmc_gatk <- readRDS("psmc/output_run_psmc_gatk.rds")
View(fAloSap1_psmc_gatk)
plot(
fAloSap1_psmc_gatk,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 3,
bin.size = 100,
xlim = c(0,100000)
)
View(snp_gt_50kb_window_filtered)
library(psmcr)
library(pegas)
library(tidyverse)
plot(
fAloSap1_psmc_gatk,
col = rgb(red = 0, green = 0, blue = 1, alpha = 0.5),
mutation.rate = 2e-09,
g = 3,
bin.size = 100,
xlim = c(0,100000)
)
